id: CVE-2021-41182

info:
  name: JQuery UI <1.13.0 - Datepicker Widget XSS 
  author: aredspy
  severity: medium
  description: |
    JQuery UI before version 1.13.0 contains a Cross-Site Scripting (XSS) vulnerability within the altField option of the Datepicker widget. The widget does not treat the field as non code input, and so an untrusted input can execute arbirary code.  
  impact: |
    Accepting the value of the altField option of the Datepicker widget from untrusted sources may execute untrusted code which will run in the victim's browser and lead to potential theft of sensitive information or session hijacking.
  remediation: |
    Update to the latest version of Jquery UI (>=1.13.0). Alternaitvley, do not accept any value into the altField option from untrusted sources such as user input.
  reference:
    - https://blog.jqueryui.com/2021/10/jquery-ui-1-13-0-released/
    - https://github.com/jquery/jquery-ui/security/advisories/GHSA-9gj3-hwp5-pmwc
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41182
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-41182
    cwe-id: CWE-79
    epss-score: 0.00279
    epss-percentile: 0.68538
    cpe: cpe:2.3:a:jqueryui:jquery_ui:*:*:*:*:*:jquery:*:*
  tags: xss,jquery,cve,cve2021

headless:
  - steps:

    #- action: debug

    - action: setheader
      args:
        part: request
        key: "User-Agent"
        value: "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:111.0) Gecko/20100101 Firefox/111.0"

    - action: navigate
      args: 
        url: "{{BaseURL}}"

    - action: waitload

    - action: script
      args:
        code: alert(document.domain)

    

